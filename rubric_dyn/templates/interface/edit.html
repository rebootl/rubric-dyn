{% extends "interface.html" %}
{% block i_body %}
  {% if preview %}
    <h3 class="i_preview_hint">Preview:</h3>
    <hr class="i_preview_line" />
    <h1>{{ page.title }}</h1>
    {% include 'post_body.html' %}
    <hr class="i_preview_line" />
  {% endif %}

  <h1>Edit</h1>
  <h2>ID: {{ id }}</h2>
  <h3>Ref: {{ page.ref }}</h3>

  <form id="edit-page"
        action="{{ url_for('interface.edit') }}"
        method="post"
        enctype="multipart/form-data"></form>

  <table>
    <tr>
      <th>Title:</th>
      <td>
        <input type="text" form="edit-page" name="title" value="{{ page.title }}"/>
      </td>
    </tr>
    <tr>
      <th>Author:</th>
      <td>
        <input type="text" form="edit-page" name="author" value="{{ page.author }}" />
      </td>
    </tr>
    <tr>
      <th>Date:</th>
      <td>
        <input type="text" form="edit-page" name="date" value="{{ page.date_norm }}" />
        (YYYY-MM-DD)
      </td>
    </tr>
    <tr>
      <th>Time:</th>
      <td>
        <input type="text" form="edit-page" name="time" value="{{ page.time_norm }}" />
        (HH:MM)
      </td>
    </tr>
    <tr>
      <th>Tags:</th>
      <td>
        <input type="text" form="edit-page" name="tags" value="{{ page.tags }}" />
        (comma separated values)
      </td>
    </tr>
    <tr>
      <th>Type:</th>
      <td>
        <input type="radio" form="edit-page" name="type" value="article" {% if page.type == 'article' %}checked{% endif %}>
          article
        </input>
        <input type="radio" form="edit-page" name="type" value="note" {% if page.type == 'note' %}checked{% endif %}>
          note
        </input>
        <input type="radio" form="edit-page" name="type" value="special" {% if page.type == 'special' %}checked{% endif %}>
          special
        </input>
        <input type="radio" form="edit-page" name="type" value="custom" {% if page.type != 'article' and page.type != 'note' and page.type != 'special' %}checked{% endif %}>
          custom
        <input type="text" form="edit-page" name="custom_type" value="{% if page.type != 'article' and page.type != 'note' and page.type != 'special' %}{{ page.type }}{% endif %}" />
        </input>
      </td>
    </tr>
  </table>

  <p>
    <input form="edit-page" type="hidden" name="id" value="{{ id }}" />
    <input form="edit-page" type="hidden" name="ref" value="{{ ref }}" />
    <button form="edit-page" type="submit" name="actn" value="preview">Preview</button>
    <button form="edit-page" type="submit" name="actn" value="save">Save</button>
    <button form="edit-page" type="submit" name="actn" value="cancel" title="Back to Overview">Cancel</button>
  </p>

  <p>
    <strong><pre>Text (Pandoc Markdown):</pre></strong>
    <textarea id="text-input" name="text-input" form="edit-page" class="edit-textarea">{{ page.body_md }}</textarea>
  </p>

  <h3>Images:</h3>

  <p>

    <pre>(hover for preview)</pre>

    <div class="prev-table-box">
      <table class="prev-table">
        {% for image in images %}
          <tr>
            <td>
              {{ image.src }}
              <div class="prev-box">
                <img class="prev-thumb" src="{{ image.thumb }}" width="100" /><br />
              </div>
            </td>
          </tr>
        {% endfor %}
      </table>
    </div>

    <table>
      <tr>
        <th>
          Insert images from server:<br />
          (media directory)
        </th>
        <td>
          /media/<input type="text" form="edit-page" name="imagepath" value=""
 /><br />
          (subdirectory path e.g.: images/2016-01-01/
        </td>
        <td>
          <button form="edit-page" type="submit" name="actn" value="add_imgs">
            Add
          </button><br />
          (adds markdown only [??])
        </td>
      </tr>
      <tr>
        <th>
          Upload and insert new images:
        </th>
        <td>
          <input type="file" form="edit-page" name="files" multiple />
        </td>
        <td>
          <button form="edit-page" type="submit" name="actn" value="upld_imgs">
            Upload
          </button>
        </td>
      </tr>
    </table>

  </p>

{% endblock %}
